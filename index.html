<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Lonny Grafman — Portfolio</title>
  <meta name="description" content="Educator, designer, and facilitator building resilient, community-led futures. Projects, teaching, and open work.">
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0c0c; --text:#e7e7e7; --muted:#a0a0a0;
      --card:#141515; --line:#1f2020;
      --accent:#39ff14;
      --radius:18px; --pad:18px; --gap:18px; --max:1080px;
      color-scheme: dark light;
    }
    @media (prefers-color-scheme: light){
      :root{ --bg:#ffffff; --text:#111; --muted:#565656; --card:#f8f8f8; --line:#eaeaea; }
    }

    html,body{margin:0; padding:0; background:var(--bg); color:var(--text);
      font:16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;}
    h1,h2,h3{font-family:"IBM Plex Mono", ui-monospace, SFMono-Regular, Menlo, monospace;}
    h1{font-size:clamp(2rem,3vw,3rem);}
    .lede{max-width:60ch; color:var(--muted);}
    .wrap{max-width:var(--max); margin-inline:auto; padding: clamp(16px, 3vw, 32px);}   
    .nav{display:flex; gap:20px; justify-content:flex-end}
    .nav__link{position:relative; text-decoration:none; color:var(--text);}    
    .nav__link::after{content:""; position:absolute; left:0; bottom:-3px; width:0; height:2px; background:var(--accent); transition:width .25s ease;}
    .nav__link:hover::after{width:100%;}
    .btn{border-radius:999px; padding:.7rem 1rem; border:1px solid var(--line); background:transparent; color:var(--text); cursor:pointer; text-decoration:none; display:inline-block}
    .btn--primary{background:var(--accent); color:#000; border:0;}

    .grid{display:grid; gap:var(--gap); grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));}
    .card{position:relative; background:var(--card); border:1px solid var(--line); border-radius:var(--radius); overflow:hidden; transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease;}
    .card img{display:block; width:100%; height:220px; object-fit:cover; filter:saturate(1.02);} 
    .card__overlay{position:absolute; inset:0; background:linear-gradient(to top, rgba(0,0,0,.7), transparent 50%); display:flex; align-items:flex-end;}
    .card__overlay h3{margin:0; padding:12px; font-size:1.1rem; color:var(--accent);}

    .scroll-progress{position:sticky; bottom:12px; height:3px; margin-top:40px; background: linear-gradient(90deg, var(--accent) var(--_pct,0%), transparent 0); border-radius:999px; opacity:.7;}

    body::after{content:""; pointer-events:none; position:fixed; inset:0; background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="140" height="140"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="0.025"/></svg>'); mix-blend-mode:overlay; opacity:.6;}
    html.punk{ --accent:#ff2dfb; filter: contrast(1.03) saturate(1.08); }
    html.punk body{ animation: crt 0.12s steps(2,end) infinite; }
    @keyframes crt { 50% { transform: translateY(.3px) } }
  .card__overlay{position:absolute; left:0; right:0; bottom:0; padding:12px 14px; color:#fff; font-family:\"IBM Plex Mono\", ui-monospace, monospace; font-weight:600; letter-spacing:.2px; text-shadow:0 1px 2px rgba(0,0,0,.6); background:linear-gradient( to top, rgba(0,0,0,.6), rgba(0,0,0,0) 70% ); border-top:1px solid rgba(255,255,255,.08);} .card:hover .card__overlay{background:linear-gradient( to top, rgba(0,0,0,.72), rgba(0,0,0,0) 70% );}
</style>
</head>
<body>
  <header class="wrap">
    <nav class="nav">
      <a href="#projects" class="nav__link">Projects</a>
      <a href="#contact" class="nav__link">Contact</a>
    </nav>
    <h1>Lonny Grafman</h1>
    <p class="lede">Educator, designer, facilitator—building resilient, solarpunk futures with real teams and real impact.</p>
    <div><a href="#projects" class="btn btn--primary">See projects</a></div>
  </header>

  <main class="wrap">
    <section id="projects">
      <h2>Projects</h2>
      <div id="projects-grid" class="grid"></div>
      <div class="scroll-progress" aria-hidden="true"></div>
    </section>

    <section id="contact">
      <h2>Contact</h2>
      <p><a class="btn btn--primary" href="mailto:hello@example.com">Email me</a></p>
    </section>
  </main>

  <footer class="wrap">
    <p>© <span id="year"></span> Lonny Grafman</p>
  </footer>

  <dialog id="modal" class="modal">
    <div class="modal__dialog">
      <img id="mImg" class="modal__img" alt="">
      <div class="modal__body">
        <button id="mClose" class="about__close" aria-label="Close">×</button>
        <h3 id="mTitle" class="modal__title"></h3>
        <div id="mMeta" class="meta"></div>
        <p id="mReason" class="meta" style="margin-top:.25rem"></p>
        <div id="mDesc" style="margin-top:10px"></div>
        <div id="mImpacts" style="margin-top:10px"></div>
        <div id="mRoles" style="margin-top:10px"></div>
        <div id="mTags" style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap"></div>
        <div id="mLinks" class="btnrow"></div>
      </div>
    </div>
  </dialog>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
    const progress = document.querySelector('.scroll-progress');
    const projects = document.getElementById('projects');
    function updateProgress(){
      const rect = projects.getBoundingClientRect();
      const total = rect.height - window.innerHeight;
      const seen = Math.min(Math.max(0, 0 - rect.top), total);
      const pct = total > 0 ? (seen/total)*100 : 0;
      progress.style.setProperty('--_pct', pct + '%');
    }
    addEventListener('scroll', updateProgress, {passive:true});
    addEventListener('resize', updateProgress);
    updateProgress();

    (() => {
      const seq = [38,38,40,40,37,39,37,39,66,65]; let i=0;
      window.addEventListener('keydown', e=>{
        i = (e.keyCode===seq[i]) ? i+1 : 0;
        if(i===seq.length){ i=0; document.documentElement.classList.add('punk'); setTimeout(()=>document.documentElement.classList.remove('punk'),10000);} });
    })();

    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRwYDBqR1Ig7T0gzs172Esm_cpJ28o8JwClwiiLtXQ65Fjd4_aVY13nKR3p_F6Qtpjq76p9yDYpsmFl/pub?output=csv";
    fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(CSV_URL)}`)
      .then(r=>r.json()).then(data=>{
        const rows = data.contents.split(/\r?\n/).map(r=>r.split(","));
        const headers = rows.shift().map(h=>h.trim().toLowerCase());
        const grid = document.getElementById('projects-grid');
        rows.forEach(cells=>{
          const row = {};
          headers.forEach((h,i)=> row[h]=cells[i]);
          if(!row.published || !/true|1|yes/i.test(row.published)) return;
          const card = document.createElement('article');
          card.className="card";
          const img = document.createElement('img');
          img.src = row.image; img.alt = row.title||\"Project image\";
          card.appendChild(img);
          const overlay = document.createElement('div');
          overlay.className = 'card__overlay';
          overlay.textContent = row.title || 'Untitled';
          card.appendChild(overlay);
          grid.appendChild(card);
        });
      });

    function openModal(item){
      const modal=document.getElementById('modal');
      document.getElementById('mImg').src=item.image;
      document.getElementById('mTitle').textContent=item.title||'';
      document.getElementById('mMeta').textContent=item.dates||'';
      document.getElementById('mReason').textContent=item.reason||'';
      document.getElementById('mDesc').textContent=item.description||'';
      document.getElementById('mImpacts').textContent=item.impacts||'';
      document.getElementById('mRoles').textContent=item.roles||'';
      const tags=document.getElementById('mTags'); tags.innerHTML='';
      if(row.tags){ row.tags.split(/[,;]/).forEach(t=>{ const span=document.createElement('span'); span.className='chip'; span.textContent=t.trim(); tags.appendChild(span); }); }
      const links=document.getElementById('mLinks'); links.innerHTML='';
      if(item.links){ item.links.split(';').forEach(l=>{ if(l){ const a=document.createElement('a'); a.className='btn'; a.target='_blank'; a.rel='noopener'; a.href=l.trim(); a.textContent='Learn more'; links.appendChild(a);} }); }
      modal.showModal();
    }
  </script>
</body>
</html>
